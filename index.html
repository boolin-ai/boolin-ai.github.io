<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>予約フォーム</title>
    <link rel="stylesheet" href="https://boolin-ai.github.io/liff-form-app/style.css">
</head>
<body>
    <header>
        <h1>サンプルクリニック</h1>
    </header>
    <div id="firstPage">
        <h2>サンプルクリニック LINE予約</h2>
        <div class="dis">
            <p>
                【ご予約の注意点】<br>
                来院当日は基本カウンセリングのみのご予約となります。
            </p>
            <p>
                ＊以下の内容のご予約をご希望の方は、<br>
                お電話、もしくはLINEトークにてご連絡ください。<br>
                (電話応答・LINE対応時間10:00 - 19:00/<a href="tel:0120-4874-25">TEL 0120-4874-25</a>)<br>
                ・当日のご予約をご希望の方<br>
                ・当日にカウンセリング＋施術をご希望の方<br>
            </p>
            <p>＊LINEメッセージは24時間お送りいただけますが、当院からのご返信は診療時間のみとさせていただきます。</p>
        </div>
        <button type="button" id="formStartBtn" class="formBtn">予約へ進む</button>
    </div>
    <div id="formPage">
        <div class="flow">
            <div>
                <strong class="flow-item">1</strong>
                <span>メニュー選択</span>
            </div>
            <div>
                <span></span>
            </div>
            <div>
                <strong class="flow-item">2</strong>
                <span>お客様情報</span>
            </div>
            <div>
                <span></span>
            </div>
            <div>
                <strong class="flow-item">3</strong>
                <span>内容確認</span>
            </div>
        </div>
        <form id="form">
            <div id="formMenu">
                <div class="form-item">
                    <div class="form-q">
                        <label>診療を選択してください</label><span class="req">*</span>
                    </div>
                    <div class="form-c">
                        <div>
                            <input type="radio" id="menu1" name="menu" value="医療脱毛カウンセリング" required>
                            <label for="menu1">医療脱毛カウンセリング</label>
                        </div>
                        <div>
                            <input type="radio" id="menu2" name="menu" value="美容全般カウンセリング" required>
                            <label for="menu2">美容全般カウンセリング</label>
                        </div>
                        <div>
                            <input type="radio" id="menu3" name="menu" value="二重埋没法カウンセリング" required>
                            <label for="menu3">二重埋没法カウンセリング</label>
                        </div>
                        <div>
                            <input type="radio" id="menu4" name="menu" value="自毛植毛カウンセリング" required>
                            <label for="menu4">自毛植毛カウンセリング</label>
                        </div>
                        <div>
                            <input type="radio" id="menu5" name="menu" value="再生医療カウンセリング" required>
                            <label for="menu5">再生医療カウンセリング</label>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label for="message">お悩みや症状についてお聞かせください</label>
                    <textarea id="message" name="message" rows="4" cols="50"></textarea>
                </div>
                <button type="button" id="formNameBtn" class="formBtn">お客様情報入力へ</button>
            </div>
            <div id="formName">
                <div class="form-item">
                    <div class="form-q"><label for="f-choice">第一希望日</label><span class="req">*</span></div>
                    <div class="form-a"><input type="text" id="f-choice" name="f-choice" placeholder="5/10 10:00" required></div>
                </div>
                <div class="form-item">
                    <div class="form-q"><label for="s-choice">第二希望日</label><span class="req">*</span></div>
                    <div class="form-a"><input type="text" id="s-choice" name="s-choice" placeholder="5/10 12:00" required></div>
                </div>
                <div class="form-item">
                    <div class="form-q"><label for="name">お名前</label><span class="req">*</span></div>
                    <div class="form-a"><input type="text" id="name" name="name" placeholder="例）田中太郎" required></div>
                </div>
                <div class="form-item">
                    <div class="form-q"><label for="phone">電話番号</label><span class="req">*</span></div>
                    <div class="form-a"><input type="tel" id="phone" name="phone" placeholder="例）080-1234-5678" required></div>
                </div>
                <div class="form-item">
                    <div class="form-q">
                        <label for="birthday">生年月日</label><span class="req">*</span>
                    </div>
                    <div class="form-a">
                        <select id="year" name="year"></select>
                        <select id="month" name="month"></select>
                        <select id="day" name="day"></select>
                    </div>
                </div>                
                <div class="form-item">
                    <div class="form-q"><label>性別<span class="req">*</span></label></div>
                    <div class="form-c">
                        <input type="radio" id="male" name="gender" value="男性" required>
                        <label for="male">男性</label>
                        <input type="radio" id="female" name="gender" value="女性" required>
                        <label for="female">女性</label>
                        <input type="radio" id="genderless" name="gender" value="その他" required>
                        <label for="genderless">その他</label>
                    </div>
                </div>
                <button type="button" id="formConfirmationBtn" class="formBtn">確認画面へ</button>
                <button type="button" id="backNameBtn" class="backBtn">戻る</button>
            </div>
            <div id="formConfirmation">
                <div class="confirmation-content"></div>
                <button type="submit" id="formSubmitBtn" class="formBtn">仮予約をする</button>
                <button type="button" id="backMenuBtn" class="backBtn">戻る</button>
            </div>
        </form>
    </div>
    <!-- ローディングアニメーションとオーバーレイ -->
    <div id="loadingOverlay" style="display: none;">
        <div id="loadingSpinner">
            <span></span>
            <span>Please wait..</span>
        </div>
    </div>
    <footer>
        <a href="https://wbc-saisei.com/privacy.php" class="policy">
            プライバシーポリシー
        </a>
    </footer>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://boolin-ai.github.io/liff-form-app/script.js"></script>
    <script> 
        document.addEventListener('DOMContentLoaded', function () {
            // ページセクション要素を取得    
            const firstPage = document.getElementById("firstPage");
            const form = document.getElementById('form');
            const formPage = document.getElementById("formPage");
            const formMenu = document.getElementById("formMenu");
            const formName = document.getElementById("formName");
            const formConfirmation = document.getElementById("formConfirmation");

            // フォーうのナビゲーション要素を取得
            const element1 = document.getElementsByClassName("flow-item")[0];
            const element2 = document.getElementsByClassName("flow-item")[1];
            const element3 = document.getElementsByClassName("flow-item")[2];

            // ボタン要素を取得
            const formStartBtn = document.getElementById("formStartBtn");
            const formNameButton = document.getElementById("formNameBtn");
            const formConfirmationButton = document.getElementById("formConfirmationBtn");
            const backNameBtn = document.getElementById("backNameBtn");
            const backMenuBtn = document.getElementById("backMenuBtn");
            const menuRadios = document.querySelectorAll('input[name="menu"]');
            const genderRadios = document.querySelectorAll('input[name="gender"]');
            const otherInputs = document.querySelectorAll('#form input[required]:not([name="menu"]):not([name="gender"])');
            
            // 初期時の表示・非表示をセット
            formPage.style.display = "none";
            formName.style.display = "none";
            formConfirmation.style.display = "none";
            // activeクラスの設定
            element1.classList.add("active");
            
            // フォーム「施術選択」を表示
            formStartBtn.addEventListener("click", function() {
                // formNameを表示し、formMenuを非表示にする
                firstPage.style.display = "none";
                formPage.style.display = "block";
                formMenu.style.display = "flex";
            });
            // フォーム「お客様情報」を表示
            formNameButton.addEventListener("click", function() {
                // 'menu'のラジオボタンの状態を再チェック
                const isMenuSelected = [...menuRadios].some(radio => radio.checked);
                if (!isMenuSelected) {
                    alert('入力されていない内容があります');
                    return; // 処理を中断
                }
                // formNameを表示し、formMenuを非表示にする
                formMenu.style.display = "none";
                formName.style.display = "flex";

                // activeクラスの設定
                element1.classList.remove("active"); // 一旦activeクラスを削除
                element2.classList.add("active");
            });
            // フォーム「施術選択」へ戻る
            backNameBtn.addEventListener("click", function() {
                // formNameを表示し、formMenuを非表示にする
                formMenu.style.display = "flex";
                formName.style.display = "none";

                // activeクラスの設定
                element1.classList.add("active"); // 一旦activeクラスを削除
                element2.classList.remove("active");
            });

            // 生年月日の情報処理
            populateYears();
            populateMonths();
            populateDays();
            styleSelectedOption(document.getElementById('year'));
            styleSelectedOption(document.getElementById('month'));
            styleSelectedOption(document.getElementById('day'));

            // フォーム「確認画面」を表示
            formConfirmationButton.addEventListener("click", function() {
                 // 'gender'のラジオボタンとその他のinput要素の状態を再チェック
                const isGenderSelected = [...genderRadios].some(radio => radio.checked);
                const areOtherInputsFilled = [...otherInputs].every(input => input.value.trim() !== '');
                
                if (!(isGenderSelected && areOtherInputsFilled)) {
                    alert('入力されていない内容があります');
                    return; // 処理を中断
                }
                // formNameを表示し、formMenuを非表示にする
                formName.style.display = "none";
                formConfirmation .style.display = "flex";

                // activeクラスの設定
                element2.classList.remove("active"); // 一旦activeクラスを削除
                element3.classList.add("active");

                // フォームデータの取得
                const menu = document.querySelector('input[name="menu"]:checked').value;
                const message = document.getElementById('message').value;
                const fChoice = document.getElementById('f-choice').value;
                const sChoice = document.getElementById('s-choice').value;
                const name = document.getElementById('name').value;
                const phone = document.getElementById('phone').value;
                const year = document.getElementById('year').value;
                const month = document.getElementById('month').value.padStart(2, '0'); // 月を2桁に
                const day = document.getElementById('day').value.padStart(2, '0'); // 日を2桁に
                const gender = document.querySelector('input[name="gender"]:checked').value;

                // 確認画面の要素を取得
                const confirmationContent = document.querySelector('.confirmation-content');

                // 確認画面に表示する内容を組み立て
                confirmationContent.innerHTML = `
                <p><span>お名前:</span> ${name}</p>
                <p><span>電話番号:</span> ${phone}</p>
                <p><span>生年月日:</span> ${year}-${month}-${day}</p>
                <p><span>性別:</span> ${gender}</p>
                <p><span>メニュー選択:</span> ${menu}</p>
                <p><span>第一希望日:</span> ${fChoice}</p>
                <p><span>第二希望日:</span> ${sChoice}</p>
                <p><span>お悩みや症状:</span></p>
                <p>${message}</p>
                `;
            });
            // フォーム「施術選択」へ戻る
            backMenuBtn.addEventListener("click", function() {
                // formNameを表示し、formMenuを非表示にする
                formName.style.display = "flex";
                formConfirmation .style.display = "none";

                // activeクラスの設定
                element2.classList.add("active"); // 一旦activeクラスを削除
                element3.classList.remove("active");
            });
        });

        function populateYears() {
            const yearSelect = document.getElementById('year');
            for (let i = new Date().getFullYear(); i >= 1900; i--) {
                yearSelect.options[yearSelect.options.length] = new Option(i, i);
            }
            yearSelect.selectedIndex = 0;
        }

        function populateMonths() {
            const monthSelect = document.getElementById('month');
            for (let i = 1; i <= 12; i++) {
                monthSelect.options[monthSelect.options.length] = new Option(i, i);
            }
            monthSelect.selectedIndex = 0;
        }

        function populateDays() {
            const daySelect = document.getElementById('day');
            for (let i = 1; i <= 31; i++) { // 簡単のため毎月31日まであるとする
                daySelect.options[daySelect.options.length] = new Option(i, i);
            }
            daySelect.selectedIndex = 0;
        }

        function styleSelectedOption(selectElement) {
            selectElement.addEventListener('change', function() {
                if (this.selectedIndex === 0) {
                    this.style.color = '';  // 初期選択オプションの色（灰色）
                } else {
                    this.style.color = '#000';  // 通常選択オプションの色（黒）
                }
            });
        }
    </script>
</body>
</html>    